{% extends 'erp/base.html' %}

{% block title %}批量上传{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>批量上传</h2>
    <div class="alert alert-info">
        <p><strong>使用说明：</strong></p>
        <ol>
            <li>请按照标准装箱单格式准备Excel文件。</li>
            <li>每个sheet代表一个装箱单，系统会自动跳过名为"常用箱规"的sheet。</li>
            <li>表头信息位置：
                <ul>
                    <li>D1单元格: 类型（普货/纺织/混装）</li>
                    <li>B1单元格: 总箱数</li>
                    <li>B2单元格: 总重量</li>
                    <li>B3单元格: 总体积</li>
                    <li>B4单元格: 总边加一体积</li>
                    <li>B6单元格: 总件数</li>
                    <li>D2单元格: 总价格</li>
                </ul>
            </li>
            <li>商品数据从第8行开始，B列为SKU，C列为中文名称。</li>
            <li>如果系统中不存在上传的SKU，将自动创建新产品。</li>
        </ol>
    </div>
    
    <div class="alert alert-warning">
        <p><strong>常见问题：</strong></p>
        <ul>
            <li><strong>格式不正确错误</strong>：确保Excel文件至少有7行数据，且B列（第2列）包含SKU信息。</li>
            <li><strong>无法识别SKU列</strong>：确保从第8行开始，B列包含有效的SKU编号。</li>
            <li><strong>文件被占用错误</strong>：上传前请确保Excel文件已关闭，不被其他程序占用。</li>
            <li><strong>导入失败</strong>：检查Excel文件格式是否符合要求，特别是SKU列和中文名称列的位置。</li>
        </ul>
    </div>
    
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="form-group">
            <label for="file">选择Excel文件：</label>
            <input type="file" class="form-control-file" id="file" name="file" accept=".xlsx,.xls" required>
            <small class="form-text text-muted">支持.xlsx和.xls格式</small>
        </div>
        <button type="submit" class="btn btn-primary">上传</button>
    </form>
</div>
{% endblock %}